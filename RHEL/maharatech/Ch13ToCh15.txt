==========Archiving and Transferring Files===========

Goal:
    Archive and copy files from one system to another.

Objectives: 
    Archive files and directories into a comperessed file using tar,
    and extract the contents of an existing tar archive.

    Transfer files to or form a remote system securely using SSH.


Managing and comperessedd TAR Archives 
    Archiving and Compressings files are useful when creating backups nd transferring data across a network 
    One of the oldest and most common commands for creatgin and working with backup archives is the <tar> command.

Options of the Tar command  
    tar -cvf ect_backup_a
        -c,--create : Create a new archive.
        -x,--extract : Extract from an existing archive.
        -t,--list : List the table of contents of an archive.
        -v,--verbose : Verbose. Shows which files get archived or extracted.
        -f,--file= :This option must be followed by the file name of the archive to user or create.
        -p,--preserve-permissions : preseve the permissions of files and directiories when extracting an archive, without subrtacting the umask.


    du <Dir/file> : estimate file space usage
        -s : Sammary 
        -sh : Sammary and Human Reading 

createing acompressed archive.
    the tar command supports three compression methods.
    gzip
    bzip2
    xz

    use one of the follwing Options to create a compressed tar archive.

        tar -czf ect_backup.tar.gz etc
        tar -cjf ect_backup.tar.bz2 etc
        tar -cJf ect_backup.tar.xz etc
            -z,--gzip : use gzip compression(.tar.gz)
            -j,--bzip2 : use bzip2 compression(.tar.bz2). bzip2 typically achivees abetter compression ratio than gzip.
            -J,--xz : use xz compression(.tar.xz). The xz compression typically achieves. abetter compression ratio than bzip2.

        du -sh *
            #27M ect
            #24M ect_backup_20240923.tar
            #4.8M ect_backup.tar.bz2
            #5.6M ect_backup.tar.gz
            #4.1M ect_backup.tar.xz

    Extract Files

        tar -xzf ect_backup.tar.gz
        tar -xjf ect_backup.tar.bz2
        tar -xJf ect_backup.tar.xz

compress and extract files using gzip,bzip2and xz.

    compress
        gzip etc.tar
        bzip2 abc.tar
        xz myarchive.tar
    extract
        gunzip etc.tar
        bunzip2 abc.tar
        unxz myarchive.tar

Transferring files using secure copy
    The secure copy command, scp, which is part of the OpenSSH suite, copies files from a remote 
    system to the local system or from the local system to a remote system.

    scp <localfile/localdir> <remoteuser@IP>:<file/dir> : from local srever to remote.
        # scp etc.tar root@192.168.1.10:/root : copy etc.tar from here to /root in remote.

    scp <file/dir>:<remotefile/remotedir> <localfile/localdir> : from remote to local.
        # scp root@192.168.1.10:/root/date.txt . : copy date.txt form root to here.

Transferring files using the secure file Transfer program
    To interactively upload or download files from a SSH server, use the Secure File Transfer Program,sftp.
    A session with the sftp command uses the secure authentication mechanism and encrypted data transfer to and from the SSH server.

    sftp <remoteuser@remotehost>
        #sftp root@192.168.1.10

        l<comand>: to run command localy.
            # lpwd : print local working directory

        put <filename> : to upload file .
            # put etc.tar : upload etc.tar to remote
        get <filename> : to download file.
            # get date.txt : download date.txt form remote




=================Installing and Updating Software Packages============

Goal 
    download,install,Update, and manage software packages fomr RedHat and Yum Package repositories.

Objectives
    install, Update, or remove software packages using Yum and RPM tools.


Explaining and investigating RPM software packages
    RPM package files names consist of four elements (Plus the .rpm suffix):
    name-version-release-architecture.rpm

        Name : is one or more words describing the contnets.
        Version : is the version nubmer of the original software.
        Release : is the release nubmerof teh package based on that version.
        Arch : is the processor architecture the package was compiled to run on.
        noarch  indicates that this package's contents are not architecture-Specific.

        hostnamectl : to track how the local system appears on a network. It also displays operating system information, including its version.
        cat /etc/redhat-release : displays operating system name and version.
        uname -a : displays information about os.


        wget <url> : The non-interactive network downloader



Explaining RPM Packages
    The RPM Package Manager (RPM) is a powerful package management system capable of
       . building computer software from source into easily distributable packages
       . installing, updating and uninstalling packaged software
       . querying detailed information about the packaged software, whether installed or not
       . verifying integrity of packaged software and resulting software installation


    rpm -qa: list all installed packages.
    rpm -q <packagename> : List what version of the package is currently installed.
        #rpm -q yum : List version of yum package 
    rpm -qf <filaname> : find out what package provieds FILENAME.

    rpm -qi <packagename> : get detailed information about the apckage.
        #rpm -qi yum :
    rpm -ql <packagename> : list the files installed by the package
        #rpm -ql yum :
    rpm -qc <packagename> : List just the confuguration files installed by the package.
        #rpm -qc yum :
    rpm -qd <packagename> : List just the documentation files installed by the package.
        #rpm -qc yum
    rpm -q --scripts <packagename> that run before or after the package is installed or removed .
        #rpm -q --scripts  openssh-server: that run before or after the openssh package is installed or removed .
    rpm -q --changelog : list change information for the package. 
        rpm -q --changelog openssh-server :information for the openssh package (version and )

Installing RPM packages.
    the rpm command can also be used to install an RPM package that you have downloaded to your local directory.
        rpm -ivh <Package.rpm> 
            -i : install package(s).
            -v : Verbosity provide more detailed output.
            -h : Installation progress ####.

remove RPM packages.
    rpm -ev <packagename> : remove package.
        rpm -ev firefox : remove firefox package.
    
Create Yum repositories
    1.mount RHEL iso image.
        mount -o loop /dev/sr0

        df -h : displays file system 
    2.create AppStream.repo and BaseOS.repo in /etc/yum.reops.d/
        cd /etc/yum.reops.d/
        touch AppStream.repo and BaseOS.repo

    3. Open each file separately and add 5 lines :
        vim AppStream.repo
             [Local_AppStream] #Id
             name="RHEL9 Locaal AppStream repository" #describtion
             baseurl=file:///media/AppStream #location
             enabled=1 #enable or disable the repo
             gpgchek=0 #Check this package to see if it is verified by Red hat or not.

        :wq
        vim BaseOS.repo
            [Local_BaseOS] #Id
             name="RHEL9 Locaal BaseOS repository" 
             baseurl=file:///media/BaseOS 
             enabled=1 
             gpgchek=0 
        :wq
        4.Check repositories 
            yum reoplist : displaps repositories
            yum reoplist --all : displays repositories with status.

Prevent warning message (updateing subscriping)
    vi /etc/yum/pluginconf.d/subscription-manager.conf
        enabled=0
    :wq

        
Installing and updating software packages with YUM
    • The low-level rpm command can be used to install packages, but it is not designed to work with
    package repositories or resolve dependencies from multiple sources automatically.
    • Yum is designed to be a better system for managing RPM-based software installation and updates.
    The yum command allows you to install, update, remove, and get information about software
    packages and their dependencies.
   
    Finding Software with Yum
    • yum help : displays usage information.
    • yum list :displays installed and available packages.

    • yum search KEYWORD :lists packages by keywords found in the name and summary filds only.


Introduction to application stream
    Two main repositories:
        The BaseOS repository mainly concernsthe operating system.

        The AppStream repository containsapplication modules and non-modularRPMS.

    IMPORTANT
        Both BaseOS and AppStream are a necessary part of a Red Hat Enterprise Linux 9 system.

List, Search, Install software package with YUM
    yum info <packagename> : information about package (== rpm qi <packagename>)
    yum lsit "<PN>*" : list all packages start with <PN>

    yum install <packname> : Find and install the package. 
        yum install httpd : install apache web server.
    yum update <packagename> : update package
        yum update httpd : update apache web server.
    yum remove <packagename> : remove package.
        yum remove httpd remove apache web server.
    yum history : Displays yum history.



Summary of RPM query commands
    Installed packages can be queried directly with the rpm command.
     Add the -p option to query a package file before installation.
    COMMAND                                TASK
    rpm -qa                                List all RPM packages currently installed
    rpm -q NAME                            Display the version of NAME installed on the system
    rpm -qi NAME                           Display detailed information about a package
    rpm -ql NAME                           List all files included in a package
    rpm -qc NAME                           List configuration files included in a package
    rpm -qd NAME                           List documentation files included in a package
    rpm -q - -changelog NAME               Show a short summary of the reason for a new package release
    rpm -q --scripts NAME                  Display the shell scripts run on package installation, upgrade, or removal
    
    
Summary of YUM commands
     Packages can be located,installed, updated, 
     and removed by name or by package groups.


    COMMAND:                                TASK:
    yum list [NAME-PATTERN]                  List installed and available packages by name
    yum group list                           List installed and available groups
    yum search KEYWORD                       Search for a package by keyword
    yum info PACKAGENAME                     Show details of a package
    yum install PACKAGENAME                  Install a package
    yum group install GROUPNAME              Install a package group
    yum update                               Update all packages
    yum remove PACKAGENAME                   Remove a package
    yum history                              Display transaction history

SUMMARY
    In this chapter, you learned:
         • Software is provided as RPM packages, which make it easy to install, upgrade, and uninstall software
         from the system.
         • The rpm command can be used to query a local database to provide information about the contents of
         installed packages and install downloaded package files.
         • yum is a powerful command-line tool that can be used to install, update, remove, and query software
         packages.
         Red Hat Enterprise Linux 9 uses Application Streams to provide a single repository to host multiple
         versions of an application's packages and its dependencies.



===================Accessing Linux File Systems========================
    Goal
         • Access, inspect, and use existing file systems on storage attached to a Linux server.
    Objectives
        • List the block devices and file systems.
        • Mount and unmount file systems and partitions in Linux.
        • Search for files on mounted file systems using the find and locate commands.

File system and mount points
    • To make the contents of a file system available in the file-system hierarchy, it must be mounted
    on an empty directory.
    • This directory is called a mount point. Once mounted, if you use Is to list that directory, you will
    see the contents of the mounted file system, and you can access and use those files normally.
    Many file systems are automatically mounted as part of the boot process.


Examining file systems
    • To get an overview of local and remote file system devices and the amount of free space
    available, run the df command
    • To improve readability of the output sizes you can use human-readable option: -h
    df : report file system disk space usage
        -h : print sizes in powers of 1024(human-readable)

    du : shows the size of all files in the current directory tree recursively.
        -h : human-readable

Identifying the block device
    Use the Isbik command to list the details of a specified block device or all the available devices.
    lsblk 
        -fp  :file system type (more details in admin II)

Mounting and unmounting file systems
    • There are two common ways to specify the file system on a disk partition to the mountcommand:
        • With the name of the device file in /dev containing the file system.
        • With the UUID written to the file system, a universally-unique identifier.
    mount <blockname> <Dirname> : mounting useing name of device
        mount /dev/vdb1 /mut/data : mounts the file system in the /dev/vdbl partition on the directory /mnt/data.
        mount /dev/nvme0n1p6 /data : mounts the file system in the /dev/nvme0n1p6 partition on the directory /data.


    mount UUID <dirname>: mounting useing UUID
        lsblk -fd or blkid : to get UUID
        mount UUiID="<UUID>" <Dirname>
    unmount <dirname>
        unmount /data : unmount /data.


    Find out which processes open a particular directory.
        lsof /data : information about files opened by processes.


    blkid : print block device attributes




Search for files on mounted file systems
    
    Locating files on the system
        A system administrator needs tools to search for files matching certain criteria on the file system.
        • This section discusses two commands that can search for files in the file-system hierarchy.
            • The locate command searches a pregenerated index for file names or file paths and returns the results instantly.
            • The find command searches for files in real time by crawling through the file-system hierarchy.

    Locating file by name
        • The locate command finds files based on the name or path to the file. It is fast because it
        looks up this information from the mlocate database.
        • However, this database is not updated in real time, and it must be frequently updated for
        results to be accurate.
        • This also means that locate will not find files that have been created since the last update of
        the database.
        • The locate database is automatically updated every day. However, at any time the root user
        can issue the updated command to force an immediate update.
        


        locate : search about file in database.
            -i : case-insensitive.
            -n <num> : limit results.
            
            locate file1 
            locate i file1
            locate -n 5 file1
        
    Searching for files in real time
        • The find command locates files by performing a real-time search in the file-system hierarchy.
        • It is slower than locate, but more accurate.
        • It can also search for files based on criteria other than the file name, such as the permissions of the 
        file, type of file, its size, or its modification time.
        • The find command looks at files in the file system using the user account that executed the search.
        • The user invoking the find command must have read and execute permission on a directory to examine its contents.
        
        find <location> -name <filename>
            find / -name sshd_config : to search for files named sshd_config starting from the / directory
        find <location> -name <'*.txt'>
            find / -name '*.txt' : search for files starting in the / directory
        find <location> -iname <'*ilenam*'>
            find / -iname '*messages*' : search files with case-insensitive test,messages, in their names in the / directory on host.
        find -user <username>
            find -user mohamed : search for files owned by mohamed in the /home/mohamed directory on host.
        find -group <groupusername>
            find -group mohamed : search for files owned by the group mohamed in the /home/user/ directory on hsot.
        find -uid <uid>
            find -uid 1000 : search for files owned by user id 1000 in the /home/user directory on host.
       find -user <username> -group <groupname> :The -user, and -group options can be used together to search files where file owner and group owner are different.
             find / -user root -group mail :  list files that are both owned by user root and affiliated with group mail

    Searching files based on ownership
        • Search for files owned by user ID 1000 in the /home/user directory on host.
            find -uid 1000
        • The -user, and -group options can be used together to search files where file owner and group owner are different.

             find / -user root -group mail : list files that are both owned by user root and affiliated with group mail
    
    
    
    Searching files based on permissions
        • The -perm option is used to look for files with a particular set of permissions. Permissions can be described as octal values, with some combination of 4, 2, and 1 for read, write, and execute.
            find /home -perm 764
        • The following command matches any file for which the user has read, write, and execute permissions,members of the group have read and write permissions, and others have read-only access:
        To match files for which the user has at least write and execute permissions, and the group has at least write permissions, and others have at least
        read access:
            find /home -perm -324


    Searching files based on size
        • The find command can look up files that match a size specified with the -size option, followed by a 
        numerical value and the unit. Use the following list as the units with the -size option:
        • k, for kilobyte           • M, for megabyte              • G, for gigabyte

            find -size 10M : To search for files with a size of 10 megabytes, rounded up.
            find -size +10G : To search the files with a size more than 10 gigabytes.
            find -size -10k : To list all files with a size less than 10 kilobytes.


            fallocate -l 1G file1 : preallocate space to a file.
    

    Searching files based on Modification time
        • The -mmin option, followed by the time in minutes, searches for all files that had their content 
        changed at n minutes ago in the past. The file's timestamp is always rounded down. It also supports 
        fractional values when used with ranges (+n and -n).

        find / -mmin 120 : To find all files that had their file content changed 120 minutes ago on host, run:

        The + modifier in front of the amount of minutes looks for all files in the / that have been modified more than n minutes ago.
            find / -mmin +200 :  files that were modified more than 200 minutes ago are listed 

    Searching files based on type
        • The -type option in the find command limits the search scope to a given file type. Use the following 
        list to pass the required flags to limit the scope of search:
        • f, for regular file      • d, for directory        • I, for soft link      • b, for block device
        find /etc -type d : Search for all directories in the /etc directory on host.
        find / -type I : Search for all soft links on host.
        find /dev -type b : Generate a list of all block devices in the /dev directory on host.


SUMMARY
    In this chapter, you learned:
        • Storage devices are represented by a special file type called block device.
        • The df command reports totäl disk space, used disk space, and free disk space on all mounted regular file systems. 
        • The mount command allows the root user to manually mount a file system.
        • All processes need to stop accessing the mount point in order to successfully unmount the device.
        • The find command performs a real-time search in the local file systems to find files based on search criteria.